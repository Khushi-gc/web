---
import card1 from "../assets/images/card1.webp";
import card2 from "../assets/images/card2.webp";
import card3 from "../assets/images/card3.webp";

const cards = [
  {
    title: "Purpose-Built Education Loans",
    description:
      "We provide accessible financing strictly for your academic journey. From tuition to living expenses, our 60+ partners offer collateral-free options designed for students. <br><br><strong>The Guardrail:</strong> Specialized funding for domestic and international degrees.<br><strong>The Stat:</strong> $72M+ in student-specific loans facilitated.",
    image: card1,
    icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 21 16" class="w-9 h-9 fill-brand-purple"><path fill-rule="evenodd" d="M1.837 2.929V4.39h17.538v1.462H1.837v7.307a.735.735 0 0 0 .73.731h16.077a.735.735 0 0 0 .731-.73V5.851h1.462v7.307a2.19 2.19 0 0 1-2.193 2.193H2.567a2.19 2.19 0 0 1-2.192-2.193V2.93A2.19 2.19 0 0 1 2.567.736h16.077a2.19 2.19 0 0 1 2.193 2.193V4.39h-1.462V2.93a.735.735 0 0 0-.73-.731H2.566a.734.734 0 0 0-.73.73m1.461 4.384h4.385v1.462H3.298z" clip-rule="evenodd"></path></svg>`,
  },
  {
    title: "Academic & Admissions Counseling",
    description:
      "Our experts donâ€™t just give advice; they provide a data-backed roadmap for your education.<br><br><strong>The Focus:</strong> 1-on-1 guidance on university selection, admission strategies, and academic career pathing.<br><strong>The Stat:</strong> 13,000+ students guided to their ideal campus.",
    image: card2,
    icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" class="w-9 h-9 fill-brand-purple"><path fill-rule="evenodd" d="M35.077 9.23v27.26l-5.668-2.835-5.409 3.6-5.41-3.6-5.667 2.834V9.231zm3.692 0h-3.692V5.539H9.23v36.924l9.101-4.551L24 41.695l5.668-3.784 9.101 4.55zm-7.384 3.693h-14.77v3.692h14.77zm-14.77 7.385h14.77V24h-14.77z" clip-rule="evenodd"></path></svg>`,
  },
  {
    title: "Specialized Test Preparation",
    description:
      "Success in your academic journey starts with the right scores. Our modules are built strictly for language and entrance exams (IELTS, etc.).<br><br><strong>The Focus:</strong> Self-paced, adaptive learning that targets your academic weaknesses.",
    image: card3,
    icon: `<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" class="w-9 h-9 fill-brand-purple"><path fill-rule="evenodd" d="M.154 14C.154 6.364 6.364.154 14 .154S27.847 6.364 27.847 14 21.637 27.846 14 27.846.154 21.636.154 14m2.77 0c0 6.106 4.97 11.077 11.076 11.077S25.077 20.107 25.077 14c0-6.106-4.97-11.077-11.077-11.077C7.894 2.923 2.924 7.893 2.924 14m14.993 3.916A5.54 5.54 0 0 0 19.539 14h2.77a8.308 8.308 0 0 1-16.616 0h2.769a5.538 5.538 0 0 0 9.455 3.916M11.23 8.462H8.462V14h2.77zm5.539 0h2.769V14h-2.77z" clip-rule="evenodd"></path></svg>`,
  },
];
---

<section class="money-confidence" id="money-confidence">
  <div class="container">
    <div class="header-section reveal-header">
      <div class="title-col">
        <h2>EMPOWERING YOUR JOURNEY</h2>
      </div>
      <div class="desc-col">
        <p>
          From funding to specialized counseling, Aveka provides the targeted
          resources you need to achieve your global ambitions.
        </p>
      </div>
    </div>

    <!-- Interactive Card Grid (Flex Accordion) -->
    <div class="cards-wrapper reveal-cards">
      {
        cards.map((card) => (
          <div class="card">
            <img src={card.image.src} alt={card.title} class="card-bg" />
            <div class="card-overlay" />

            <div class="card-content-wrapper">
              <div class="glass-panel">
                <div class="content-flex">
                  <div class="icon-box">
                    <div class="icon" set:html={card.icon} />
                  </div>

                  <div class="text-content">
                    <h4>{card.title}</h4>
                    <div class="description-wrapper">
                      <p set:html={card.description} />
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<style>
  .money-confidence {
    width: 100%;
    padding: 6rem 1rem;
    background: #fff;
    color: #000;
    overflow: hidden;
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
  }

  /* Header */
  .header-section {
    display: flex;
    flex-direction: column;
    gap: 2rem;
    margin-bottom: 4rem;
  }

  @media (min-width: 1024px) {
    .header-section {
      flex-direction: row;
      justify-content: space-between;
      align-items: flex-end;
    }
  }

  .title-col h2 {
    font-size: 2.5rem;
    line-height: 1.1;
    font-weight: 700;
    text-transform: uppercase;
    color: #1a1a1a;
    margin: 0;
  }

  @media (min-width: 1024px) {
    .title-col h2 {
      font-size: 3.5rem;
      max-width: 650px;
    }
  }

  .desc-col p {
    font-size: 1.125rem;
    color: #6b7280;
    line-height: 1.6;
    max-width: 500px;
    margin: 0;
  }

  /* Cards Wrapper - Flex Accordion */
  .cards-wrapper {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
    min-height: 500px;
  }

  @media (min-width: 1024px) {
    .cards-wrapper {
      flex-direction: row;
      min-height: 600px;
    }
  }

  /* Individual Card */
  .card {
    position: relative;
    flex: 1;
    min-width: 0;
    border-radius: 2rem;
    overflow: hidden;
    background: #f3f4f6;
    cursor: pointer;
    box-shadow:
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 2px 4px -1px rgba(0, 0, 0, 0.06);
    border: 1px solid #e5e7eb;
    transition: flex 0.7s cubic-bezier(0.25, 1, 0.5, 1);
  }

  /* Hover State - Expansion */
  .card:hover {
    flex: 4; /* Grows significantly on hover */
  }

  /* Background Image */
  .card-bg {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    object-fit: cover;
    filter: grayscale(0.5);
    transition: filter 0.7s ease;
  }

  .card:hover .card-bg {
    filter: grayscale(0);
  }

  /* Gradient Overlay */
  .card-overlay {
    position: absolute;
    inset: 0;
    background: linear-gradient(
      to top,
      rgba(0, 0, 0, 0.6) 0%,
      transparent 50%,
      transparent 100%
    );
    opacity: 0.6;
    transition: opacity 0.5s ease;
  }

  .card:hover .card-overlay {
    opacity: 0.4;
  }

  /* Content Positioning */
  .card-content-wrapper {
    position: absolute;
    bottom: 0;
    left: 0;
    right: 0;
    padding: 2rem;
    transform: translateY(1rem);
    transition: transform 0.5s ease;
  }

  .card:hover .card-content-wrapper {
    transform: translateY(0);
  }

  /* Glass Panel */
  .glass-panel {
    background: rgba(255, 255, 255, 0.95);
    backdrop-filter: blur(12px);
    padding: 2rem;
    border-radius: 1.5rem;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    transition: all 0.5s ease;
    max-width: 100%;
  }

  .card:hover .glass-panel {
    /* Limit width on hover on large screens to look neat */
  }

  @media (min-width: 1024px) {
    .card:hover .glass-panel {
      max-width: 32rem; /* lg */
    }
  }

  .content-flex {
    display: flex;
    flex-direction: column;
    gap: 1.5rem;
  }

  /* Icon Animation */
  .icon-box {
    transform-origin: left;
    transition: transform 0.5s ease;
  }

  .card:hover .icon-box {
    transform: scale(1.1) rotate(6deg);
  }

  .icon :global(svg) {
    width: 2.5rem;
    height: 2.5rem;
    fill: #6200ee; /* Brand Purple */
  }

  /* Text Content */
  .text-content h4 {
    font-size: 1.25rem;
    font-weight: 700;
    color: #1a1a1a;
    margin: 0 0 0.75rem 0;
  }

  @media (min-width: 1024px) {
    .text-content h4 {
      font-size: 1.5rem;
    }
  }

  .description-wrapper {
    max-height: 0;
    opacity: 0;
    overflow: hidden;
    transition: all 0.7s cubic-bezier(0.25, 1, 0.5, 1);
    transition-delay: 0.1s;
  }

  .card:hover .description-wrapper {
    max-height: 15rem; /* Allow enough height */
    opacity: 1;
  }

  .description-wrapper p {
    margin: 0;
    color: #6b7280;
    line-height: 1.6;
    font-size: 0.95rem;
  }

  @media (min-width: 1024px) {
    .description-wrapper p {
      font-size: 1rem;
    }
  }

  /* Smoother shared layout transition */
  .card {
    will-change: flex;
  }
</style>

<script>
  import { gsap } from "gsap";
  import { ScrollTrigger } from "gsap/ScrollTrigger";

  gsap.registerPlugin(ScrollTrigger);

  document.addEventListener("DOMContentLoaded", () => {
    gsap.from(".reveal-header", {
      scrollTrigger: {
        trigger: "#money-confidence",
        start: "top 80%",
      },
      y: 50,
      opacity: 0,
      duration: 1,
      ease: "power3.out",
    });

    gsap.from(".cards-wrapper", {
      scrollTrigger: {
        trigger: ".reveal-cards",
        start: "top 70%",
      },
      y: 50,
      opacity: 0,
      duration: 1,
      ease: "power3.out",
    });

    // Animate children stagger
    /* 
       Note: Animating flex items on load can be tricky with the flex transition.
       We'll settle for fading in the wrapper or staggering the items gently 
       without conflicting with the flex layout engine.
    */
    gsap.from(".card", {
      scrollTrigger: {
        trigger: ".reveal-cards",
        start: "top 70%",
      },
      x: 50,
      opacity: 0,
      duration: 0.8,
      stagger: 0.1,
      ease: "power2.out",
      clearProps: "all" /* Clear so CSS hover works perfectly */,
    });
  });
</script>
```
